# SpatialDB - GPU-—É—Å–∫–æ—Ä–µ–Ω–Ω–∞—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

---

## –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞
**SpatialDB** - —ç—Ç–æ –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å 3D-–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏, –∏—Å–ø–æ–ª—å–∑—É—é—â–∞—è NVIDIA PhysX –¥–ª—è GPU-—É—Å–∫–æ—Ä–µ–Ω–∏—è. –ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –≥–µ–æ–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (LiDAR, —Ñ–æ—Ç–æ–≥—Ä–∞–º–º–µ—Ç—Ä–∏—è, –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —Å–∫–∞–Ω—ã) —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —Ç–æ—á–Ω–æ—Å—Ç—å —Ä–∞—Å—á–µ—Ç–æ–≤.

### –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- üöÄ GPU-—É—Å–∫–æ—Ä–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- üåê –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–±–ª–∞—á–Ω—ã—Ö —Ö—Ä–∞–Ω–∏–ª–∏—â –¥–∞–Ω–Ω—ã—Ö
- üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
- üìä –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è 3D-–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
- ‚ö° –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫:
```
    A[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å] --> B[Python API]
    B --> C[Native Core]
    C --> D[PhysX Engine]
    C --> E[PROJ Library]
    D --> F[CUDA]
    E --> G[Geospatial Data]
    C --> H[Cloud Storage]
```
## –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã:
1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:
* –õ–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã (LAS, OBJ, PLY)
* –û–±–ª–∞—á–Ω—ã–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ (S3, GCS)
* –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —Å–∫–∞–Ω—ã (DICOM, NIfTI)

2. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≤ –µ–¥–∏–Ω—É—é —Å–∏—Å—Ç–µ–º—É

3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:
* –í–æ–∫—Å–µ–ª–∏–∑–∞—Ü–∏—è
* –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ BVH

4. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤:
* Raycasting
* –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
* –ê–Ω–∞–ª–∏–∑ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏

5. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ —ç–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

_____

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
# –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–∏—Å—Ç–µ–º–µ:
* –û–°: Windows 10/11 –∏–ª–∏ Ubuntu 20.04+
* GPU: NVIDIA —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π CUDA (RTX 3060+)
* RAM: 16–ì–ë+
* –ü–û:
* * CUDA Toolkit 11.0+
* * PhysX SDK 5.1+
* * Python 3.8+

–£—Å—Ç–∞–Ω–æ–≤–∫–∞:
```
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
https://github.com/5c0uT/SpartialDB_core.git
cd spatialdb

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –°–±–æ—Ä–∫–∞ –Ω–∞—Ç–∏–≤–Ω–æ–≥–æ –º–æ–¥—É–ª—è (Windows)
.\clean_and_build.ps1

# –°–±–æ—Ä–∫–∞ –Ω–∞—Ç–∏–≤–Ω–æ–≥–æ –º–æ–¥—É–ª—è (Linux)
mkdir build && cd build
cmake .. -DCMAKE_BUILD_TYPE=Release
make -j8
```
# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:

```
from spatial_db import SpatialConfig

config = SpatialConfig(
    voxel_size=0.1,      # –†–∞–∑–º–µ—Ä –≤–æ–∫—Å–µ–ª—è –¥–ª—è –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏
    crs="EPSG:3857",     # –¶–µ–ª–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
    gpu_device=0,        # –ò–Ω–¥–µ–∫—Å GPU —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
    cache_size=10,       # –†–∞–∑–º–µ—Ä –∫—ç—à–∞ (–≤ –ì–ë)
    streaming_chunk=10_000_000  # –†–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞ –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
)
```

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
# SpatialDB
–û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:
```
from spatial_db import SpatialDB, SpatialConfig

config = SpatialConfig(voxel_size=0.1, crs="EPSG:3857")
db = SpatialDB(config)
```

–ú–µ—Ç–æ–¥—ã:

| –ú–µ—Ç–æ–¥ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –í–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|-----------|-----------------------|----------|
| `load_las` | `path: str`, `crs: str` | `None` | –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö LiDAR |
| `load_mesh` | `path: str` | `None` | –ó–∞–≥—Ä—É–∑–∫–∞ 3D –º–æ–¥–µ–ª–∏ |
| `batch_raycast` | `origins: np.ndarray`, `directions: np.ndarray`, `max_dists: np.ndarray` | `List[RayHit]` | –ü–∞–∫–µ—Ç–Ω—ã–π raycast |
| `profile_terrain` | `start: Tuple[float, float]`, `end: Tuple[float, float]`, `width: float=5.0` | `pd.DataFrame` | –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –º–µ—Å—Ç–Ω–æ—Å—Ç–∏ |
| `query_sphere` | `center: Tuple[float, float, float]`, `radius: float` | `List[int]` | –ü–æ–∏—Å–∫ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ —Å—Ñ–µ—Ä–µ |

# SpatialDataset
–ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –Ω–∞–±–æ—Ä–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
```
dataset = db.load_dataset("https://storage.example.com/data.las", "las")
simplified = dataset.simplify(tolerance=0.5)
simplified.visualize()
```

# CoordinateConverter
–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç

–ü—Ä–∏–º–µ—Ä:
```
converter = CoordinateConverter("EPSG:4326", "EPSG:3857")
x, y, z = 37.617, 55.755, 150
converted = converter.convert(x, y, z)
```

## –†–∞–±–æ—Ç–∞ —Å API
# –§–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö
–¢–æ—á–∫–∏:
```
# –û–¥–∏–Ω–æ—á–Ω–∞—è —Ç–æ—á–∫–∞
point = (x, y, z)

# –ú–∞—Å—Å–∏–≤ —Ç–æ—á–µ–∫
points = np.array([
    [x1, y1, z1],
    [x2, y2, z2],
    ...
])
```
–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
# –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π –ª—É—á
direction = (0, 0, -1)

# –ú–∞—Å—Å–∏–≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π
directions = np.tile([0, 0, -1], (1000, 1))
```
# RayHit –æ–±—ä–µ–∫—Ç
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ raycast:
```
class RayHit:
    position: Tuple[float, float, float]  # –ü–æ–∑–∏—Ü–∏—è –ø–æ–ø–∞–¥–∞–Ω–∏—è
    normal: Tuple[float, float, float]     # –ù–æ—Ä–º–∞–ª—å –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏
    distance: float                       # –î–∏—Å—Ç–∞–Ω—Ü–∏—è –¥–æ –ø–æ–ø–∞–¥–∞–Ω–∏—è
    objectID: int                         # ID –æ–±—ä–µ–∫—Ç–∞
```
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
```
try:
    hits = db.batch_raycast(origins, directions, max_dists)
except SpatialDBError as e:
    logger.error(f"Raycast failed: {e}")
    # Fallback to CPU implementation
```
# –ü–∞–∫–µ—Ç–Ω—ã–π raycast
```
import numpy as np
from spatial_db import SpatialDB

db = SpatialDB()
origins = np.random.uniform(0, 100, (10000, 3))
directions = np.tile([0, 0, -1], (10000, 1))
max_dists = np.full(10000, 200.0)

hits = db.batch_raycast(origins, directions, max_dists)
hit_distances = [h.distance for h in hits if h.distance > 0]
```

____

–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è - gis_terrain.py, lidar_medical.py
